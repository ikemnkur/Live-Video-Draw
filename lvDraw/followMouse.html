<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Rotating Shapes</title>
</head>

<body>

<canvas id="myCanvas" width="800" height="600" style="border:1px solid #000;"></canvas>

<script>
    const canvas = document.getElementById('myCanvas');
    const ctx = canvas.getContext('2d');

    let isShapeClicked = false;
    let selectedShape = null;

    class Shape {
        constructor(x, y, color, speed) {
            this.x = x;
            this.y = y;
            this.color = color;
            this.rotation = 0;
            this.speed = speed;
            this.following = false;
        }

        draw() {}

        rotate() {
            this.rotation += this.speed;
        }

        distanceTo(point) {
            return Math.sqrt((point.x - this.x) ** 2 + (point.y - this.y) ** 2);
        }

        followMouse(mouseX, mouseY) {
            this.x = mouseX;
            this.y = mouseY;
        }
    }

    class Triangle extends Shape {
        draw() {
            const size = 50;

            ctx.beginPath();
            ctx.moveTo(this.x, this.y - size);
            ctx.lineTo(this.x + size, this.y + size);
            ctx.lineTo(this.x - size, this.y + size);
            ctx.closePath();

            ctx.fillStyle = this.color;
            ctx.fill();
            ctx.lineWidth = 2;
            ctx.strokeStyle = 'black';
            ctx.stroke();
        }
    }

    class Circle extends Shape {
        draw() {
            const radius = 40;
            ctx.beginPath();
            ctx.arc(this.x, this.y, radius, 0, 1 * Math.PI);
            ctx.fillStyle = this.color;
            ctx.fill();
            ctx.lineWidth = 2;
            ctx.strokeStyle = 'black';
            ctx.stroke();
        }
    }

    class Square extends Shape {
        draw() {
            const side = 60;
            ctx.beginPath();
            ctx.rect(this.x - side / 2, this.y - side / 2, side, side);
            ctx.fillStyle = this.color;
            ctx.fill();
            ctx.lineWidth = 2;
            ctx.strokeStyle = 'black';
            ctx.stroke();
        }
    }

    const shapes = [
        new Triangle(200, 300, 'red', 0.02),
        new Circle(400, 300, 'green', 0.01),
        new Square(600, 300, 'blue', 0.03)
    ];

    function drawScene() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        for (const shape of shapes) {
            ctx.save();
            ctx.translate(shape.x, shape.y);
            ctx.rotate(shape.rotation);
            ctx.translate(-shape.x, -shape.y);
            shape.draw();
            ctx.restore();

            if (!shape.following) {
                shape.rotate();
            }
        }

        requestAnimationFrame(drawScene);
    }

    canvas.addEventListener('mousedown', (e) => {
        const rect = canvas.getBoundingClientRect();
        const mouseX = e.clientX - rect.left;
        const mouseY = e.clientY - rect.top;

        for (const shape of shapes) {
            if (shape.distanceTo({x: mouseX, y: mouseY}) < 60) {
                if (!isShapeClicked) {
                    shape.following = true;
                    selectedShape = shape;
                    isShapeClicked = true;
                } else if (selectedShape === shape) {
                    shape.following = false;
                    selectedShape = null;
                    isShapeClicked = false;
                }
                break;
            }
        }
    });

    canvas.addEventListener('mousemove', (e) => {
        if (selectedShape && selectedShape.following) {
            const rect = canvas.getBoundingClientRect();
            const mouseX = e.clientX - rect.left;
            const mouseY = e.clientY - rect.top;
            selectedShape.followMouse(mouseX, mouseY);
        }
    });

    drawScene();
</script>

</body>
</html>
